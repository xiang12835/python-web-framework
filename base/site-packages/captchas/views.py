from django.http import Http404, HttpResponse
from django.conf import settings

from Captcha import PersistentFactory
from factory import CacheFactory


def captcha_image(request, id):
    factory = CacheFactory()
    test = factory.get(str(id))
    if not test:
        raise Http404
    response = HttpResponse(mimetype='image/jpeg')
    test.render().save(response,'JPEG')
    return response
