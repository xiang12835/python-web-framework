{% extends "admin/base_site.html" %}
{% load adminmedia admin_list reporting i18n %}
    
<!-- JAVASCRIPTS -->
{% block javascripts %}
    {{ block.super }}
    {% if cl.formset %}
        {% url admin:jsi18n as jsi18nurl %}
        <script type="text/javascript" src="{{ jsi18nurl|default:'../../jsi18n/' }}"></script>
    {% endif %}
    {{ media }}
    <script type="text/javascript" charset="utf-8">
        (function($) {
            $(document).ready(function() {
                grappelli.initSearchbar();
                grappelli.initFilter();
                // HACK: add no-wrap to table-elements.
                // should be solved with http://code.djangoproject.com/changeset/15658
                // grappelli.initTableElements(); 
            });
        })(django.jQuery);
    </script>
{% endblock %}

{% block bodyclass %}change-list{% endblock %}
{% block content-class %}content-flexible{% endblock %}

{% block breadcrumbs %}
<div id="breadcrumbs">
     <a href="/admin/">{% trans "Home" %}</a> &rsaquo;
     <a href="{% url reporting-list %}">{% trans "Reports" %}</a> &rsaquo;
     {{report.verbose_name}} 

</div>
{% endblock %}



{% block content %}

    {% if report.has_filters %}
	    <div class="module changelist-filter">
			<div class="module pagination">
				<ul class="pagination">
				  {% if report.detail_list_display %}
					<li><span>{% trans "Details" %}:</span></li>
				    <li>{{report.details_switch|safe}}</li>
			      {% endif %}
					<li><span>{% trans "Group by" %}:</span></li>
			      {% for url, name, selected in report.group_by_links %}
					{% if selected %}
					<li><span class="this-page">{{name}}</span></li>
					{% else %}
					<li><a href="{{url}}">{{name}}</a></li>
					{% endif %}
			      {% endfor %}
				</ul><br clear="all">
			</div>
          <!-- FILTERS -->
          {% if report.has_filters %}
              <div id="filters" class="module filter span-6">
                  <div class="pulldown-container">
                      <a href="javascript://" class="button toggle-filters">{% trans 'Filter' %}</a>
                      <div class="filter-pulldown">
                          {% for spec in report.filter_specs %}{% admin_list_filter report spec %}{% endfor %}
                      </div>
                  </div>
              </div>
          {% endif %}
          <br clear="all" />
	    </div>
	{% endif %}

    {% block object-tools %}{% endblock %}
    
    {% block date_hierarchy %}{% report_date_hierarchy report %}{% endblock %}
    
    <div class="container-full" id="changelist">
	
      {% block result_list %}
	  <div class="module changelist-results">
			<table>
			{% if not report.show_details %}
				<thead>
				<tr>
				{% for head in report.get_headers %}
					<th class="{{head.css_class}}"><a href="{{head.url}}">{{head.text}}</a></th>
				{% endfor %}
				</tr>
				</thead>
			{% endif %}
			{% for row in report.results %}
			{% if not report.show_details %}
				<tr class="row{% if forloop.counter0|divisibleby:"2" %}1{%else%}2{% endif %}">
					{% for value in row.values %}<td>{{value}}</td>{% endfor %}
				</tr>
			{% else%}
				<tr class="row{% if forloop.counter0|divisibleby:"2" %}1{%else%}2{% endif %}">
					<td colspan="{{report.header_count}}" style="text-align: left;"><strong>{{row.values.0}}</strong></td>
				</tr>
			{% endif %}
			{% if row.details %}
				<thead>
				<tr class="row{% if forloop.counter0|divisibleby:"2" %}1{%else%}2{% endif %}">
					<th style="border-bottom: 0px;"></th>
					{% for col in report.get_details_headers %}<th>{{col}}</th>{% endfor %}
				</tr>
				</thead>
				{% for details_row in row.details %}
				<tr class="row{% if forloop.parentloop.counter0|divisibleby:"2" %}1{%else%}2{% endif %}">
					<td style="border-bottom: 0px;"></td>
					{% for value in details_row %}<td>{{value}}</td>{% endfor %}
				</tr>
				{% endfor %}
				{% if report.show_details %}
					<tr class="row{% if forloop.counter0|divisibleby:"2" %}1{%else%}2{% endif %}">
						{% for value in row.values %}
							{% if not forloop.counter0 %}
								<td></td>
							{% else %}
								<td><strong>{{value}}</strong></td>
							{% endif %}
						{% endfor %}
					</tr>
				{% endif %}

			{% endif %}
			{% endfor %}
			{% if report.aggregate %}
			<tr>
				<td> </td>
				{% for title, value in report.get_aggregation %}
					<td><strong>{{title}}: {{value}}</strong></td>
				{% endfor %}
			</tr>
			{% endif %}
			</table>
		</div>
      {% endblock %}
    </div>
{% endblock %}
