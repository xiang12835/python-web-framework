<!DOCTYPE html>
<html>

	<head lang="zh-CN">
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="renderer" content="webkit">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
		<meta name="format-detection" content="telephone=no">
		<meta name="screen-orientation" content="portrait">
		<meta name="x5-orientation" content="portrait">
		<meta name="Keywords" content="必胜公考">
		<meta name="Description" content="必胜公考">
		<title>收益提现</title>
		<link rel="stylesheet" type="text/css" href="../css/main.css" />
		<link rel="stylesheet" type="text/css" href="../css/base.css" />
		<style type="text/css">
			ul li{list-style: none;}
			.track-rcol{width: 900px; border: 1px solid #eee;}
			.track-list{margin: 20px; padding-left: 5px; position: relative;}
			.track-list li{position: relative; padding: 9px 0 0 25px; line-height: 18px; border-left: 1px solid #d9d9d9; color: #999;}
			.track-list li.first{color: red; padding-top: 0; border-left-color: #fff;}
			.track-list li .node-icon{position: absolute; left: -6px; top: 50%; width: 11px; height: 11px; background: url(../img/order-icons.png)  -21px -72px no-repeat;}
			.track-list li.first .node-icon{background-position:0 -72px;}
			.track-list li .time{margin-right: 20px; position: relative; top: 4px; display: inline-block; vertical-align: middle;}
			.track-list li .txt{max-width: 600px; position: relative; top: 4px; display: inline-block; vertical-align: middle;white-space: nowrap;}
			.track-list li.first .time{margin-right: 20px; }
			.track-list li.first .txt{max-width: 600px; }
		</style>
	</head>

	<body>
		<div class="">
			<div class="item" style="">
				<div class="balance">
					<header>
						<div class="headtitle">
							必胜公考
						</div>
						<div class="earnings clearfix">
							<dl>
								<dt>我的余额</dt>
								<dd id="has_cashback_money" class="draw_income">1</dd>
							</dl>
							<dl>
								<dt>可提现金额</dt>
								<dd id="withdraw_money_able" class="next_income">1</dd>
							</dl>
						</div>

						<div style="padding: 30px;">
							<div style="width: 100%;text-align: center;font-size: 16px;margin-top: 10px;">提现说明</div>
							<div style="font-size: 12px;margin-top: 20px;line-height: 16px;">1.提现规则：满100元方可提现</div>
							<div style="font-size: 12px;margin-top: 10px;line-height: 16px;">2.提现进度：申请提现后，提现金额会在当日24小时内返还至您<span>当前微信账户</span>。偶有延迟，请耐心等待。</div>
							<div style="font-size: 12px;margin-top: 10px;line-height: 16px;">3.如遇账号金额不符或其他问题，请您登陆必胜公考APP，进入班级群，向您的教务老师反馈、核实。</div>
						</div>

						<!-- ios客户端 或 浏览器-->
						<div class="btn-wrap">
							<a class="btn btn-bg" href="https://h.huajiao.com/dealwith/drawCash" onclick="withdrawsub()">立即提现</a>
						</div>

						<!-- 安卓或者ios 微信或浏览器环境展示 -->
						<div class="accountOut">
							<a href="#" onclick="outlogin()">退出登录</a>
							<a href="#" onclick="withdrawRecord()">提现记录</a>
						</div>
					</header>

				</div>

			</div>
		</div>
		
		<!--模态框     提现记录-->
		<div id="showcode" class="mask showcodemodle hide" onclick="cancel_code()">
			<dl class="form">
				<div id="hdb_stadiv" class="track-list">

				</div>
			</dl>
		</div>
		
		<script id="hdb_staul" type="text/x-handlebars-template">
			<ul>
				{{#each withdraw_record_list}}
				 <li class="dd">
						<i class="node-icon"></i>
						<span class="txt">提现课程：{{course_name}}</span>
						<span class="time">提现时间：{{time}}</span>
						
						<span class="txt">提现金额：{{money}}</span>
				 </li>
				{{/each}}
			</ul>
		</script>

		<script src="../js/jquery.js" type="text/javascript" charset="utf-8"></script>
		<script src="../js/handlebars-v4.0.11.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			function setCookie(name, value, Days) {
				var exp = new Date();
				exp.setTime(exp.getTime() + Days * 24 * 60 * 60 * 1000);
				document.cookie = name + "=" + escape(value) + ";expires=" + exp.toGMTString() + "; path=/";
			}

			function outlogin() {
				setCookie('user_id', "", -1);
				Window.location.href='../login.html';
			}

			window.onload = function() {
				//var user_id = getCookie('user_id');
				var user_id = '18811129106';
				var url = 'https://api.web.platform.winlesson.com/api/live/gzh/h5/withdraw/my_balance?user_id=' + user_id;
				$.ajax({
					type: "POST",
					url: url,
					dataType: "json",
					success: function(res) {
						console.log(res);
						if(res.data.code = 200) {
							//			"has_cashback_money": 账户余额,
							//          "withdraw_money_able": 可提现金额,
							//          "has_withdraw_money": 已提现金额,   
							$("#has_cashback_money").html(res.data.has_cashback_money);
							$("#withdraw_money_able").html(res.data.withdraw_money_able);
						} else {
							alert(res.data.msg);
						}
					}
				});

			}
			
			//获取提现记录
			function withdrawRecord() {
				
				//var user_id = getCookie('user_id');
				var user_id = '18811129106';
				var url = 'https://api.web.platform.winlesson.com/api/live/gzh/h5/withdraw/withdraw_record?user_id=' + user_id;
				$.ajax({
					type: "POST",
					url: url,
					dataType: "json",
					success: function(res) {
						console.log(res);
						if(res.code = 200) {
							 
							//注册一个Handlebars模版，通过id找到某一个模版，获取模版的html框架
							var template = Handlebars.compile($("#hdb_staul").html());
							//模板加载
							$("#hdb_stadiv").html(template(res.data));
							$("#hdb_stadiv .dd:first").addClass("first");
						} else {
							alert(data.msg);
						}
					}
				});
				showmodelqc();
			}
			
			
			function showmodelqc () {//显示模态框-提现记录
				 $(".showcodemodle").removeClass('hide');
			}
			function cancel_code () {//关闭模态框
				 $(".showcodemodle").addClass('hide');
			}
			
			function withdrawsub(){	//立即提现
				var user_id = getCookie('user_id');
				$.ajax({
					type: "POST",
					url: url,
					dataType: "json",
					success: function(res) {
						console.log(res);
					}
				});
			}
		</script>

	</body>

</html>